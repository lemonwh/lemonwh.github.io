---
layout:     post
title:      æœ¬åœ°å¼€å‘ç¯å¢ƒå‡†å¤‡å’Œå¤ç›˜
subtitle:   MySQL@5.7ã€Redis@4.0ã€Zookeeper@3.4.6
date:       2021-07-13
author:     HH
header-img: img/post-bg-debug.png
catalog: true
tags:
    - Mac
    - MySQL
---

## æœ¬åœ°å¼€å‘ç¯å¢ƒå‡†å¤‡å’Œå¤ç›˜

### Brew

åœ¨macå¼€å‘å’Œæœ¬åœ°æµ‹è¯•ï¼Œå°‘ä¸äº†è¦å®‰è£…ä¸€äº›è½¯ä»¶ï¼Œæ¯”å¦‚Javaå¸¸è§çš„ä¾èµ–ï¼šmysqlã€redisã€zookeeperç­‰ã€‚

åœ¨macä¸Šå®‰è£…äº†brewåï¼Œå°±åƒWindowsä¸‹çš„å„ç±»è½¯ä»¶ç®¡å®¶ä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥æ‹‰å–è½¯ä»¶ï¼Œé¿å…äº†å»å®˜ç½‘ä¸‹è½½çš„éº»çƒ¦ã€‚

å®‰è£…brewçš„æ–¹å¼ï¼šè¿›å…¥macç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ˆä¸èƒ½ç¿»å¢™è€…çš„ç¦éŸ³ï¼Œæœ‰giteeçš„ä¸­è½¬ï¼‰

```
/bin/zsh -c "$(curl -fsSL https://gitee.com/cunkai/HomebrewCN/raw/master/Homebrew.sh)"
```

å¤ç›˜ï¼š

1. zshï¼Œä¸€æ¬¾ç”¨äºäº¤äº’å¼ä½¿ç”¨çš„shellï¼Œå¯ä»¥ä½œä¸ºè„šæœ¬è§£é‡Šå™¨æ¥ä½¿ç”¨ã€‚å…¶åŒ…å«äº†bashã€kshã€tcshç­‰å…¶ä»–shellä¸­è®¸å¤šä¼˜ç§€åŠŸèƒ½ã€‚macOS Catalinaç‰ˆå¼€å§‹ï¼Œå…¶é»˜è®¤shellä»bashæ”¹ä¸ºzshã€‚
2. -cï¼ŒTake the first argument as a command to execute, rather than reading commands from a script or standard input. If any futhers arguments are given, the first one is assigned to $0, rather than being used as a positional parameter.

### Zookeeper

å®‰è£…zookeeperï¼Œåœ¨ç»ˆç«¯è¾“å…¥ä¸‹é¢çš„å‘½ä»¤

```
brew install zookeeper
```

### MySQL

å®‰è£…MySQLåœ¨ç»ˆç«¯è¾“å…¥ä¸‹é¢çš„å‘½ä»¤

```
brew install mysql
```

å®‰è£…è¿‡ç¨‹ä¸­ä¾èµ–äº†openssl@1.1

```
==> Downloading https://mirrors.ustc.edu.cn/homebrew-bottles/bottles/openssl%401.1-1.1.1k.mojave.bottle.tar.gz
######################################################################## 100.0%
==> Downloading https://mirrors.ustc.edu.cn/homebrew-bottles/bottles/mysql%405.7-5.7.34.mojave.bottle.tar.gz
######################################################################## 100.0%
==> Installing dependencies for mysql@5.7: openssl@1.1
==> Installing mysql@5.7 dependency: openssl@1.1
==> Pouring openssl@1.1-1.1.1k.mojave.bottle.tar.gz
Warning: The post-install step did not complete successfully
You can try again using:
  brew postinstall openssl@1.1
==> Summary
ğŸº  /usr/local/Cellar/openssl@1.1/1.1.1k: 8,071 files, 18.4MB
==> Installing mysql@5.7
==> Pouring mysql@5.7-5.7.34.mojave.bottle.tar.gz
==> /usr/local/Cellar/mysql@5.7/5.7.34/bin/mysqld --initialize-insecure --user=jiawenhao --basedir=/usr/local/Cellar/mysql@5.7/5.7.34 --datadir=/usr/local/var/mysql --tmpdir=/tmp
==> Caveats
```

é€šè¿‡å®‰è£…ä¿¡æ¯ï¼Œæˆ‘ä»¬èƒ½å¤Ÿçœ‹åˆ°

> --basedir=/usr/local/Cellar/mysql@5.7/5.7.34
>
> --datadir=/usr/local/var/mysql
>
> --tmpdir=/tmp

åœ¨è¿™é‡Œæˆ‘ä»¬æ‰©å±•ä¸€ä¸‹/usrç›®å½•ã€‚å®ƒçš„å…¨ç§°å¯èƒ½æ˜¯Unix System/Software Resourcesã€‚/usræ˜¯unixç³»ç»Ÿæœ€é‡è¦çš„ç›®å½•ä¹‹ä¸€ï¼Œæ¶µç›–äº†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå„ç§æ–‡æ¡£ï¼Œå„ç§å¤´æ–‡ä»¶ï¼Œè¿˜æœ‰å„ç§åº“æ–‡ä»¶ï¼Œè¿˜æœ‰è¯¸å¤šç¨‹åºï¼Œå¦‚ftpï¼Œtelnetç­‰ç­‰ã€‚ä¸‹é¢ç®€å•ç½—åˆ—ä¸€ä¸‹å¯èƒ½å­˜åœ¨çš„ç›®å½•çš„å«ä¹‰ï¼š

- /usr/binï¼šæ‰€æœ‰å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚gcc/firefox(æŒ‡ä¸åœ¨/sbinå’Œ/binå†…çš„)
- /usr/includeï¼šå„ç§å¤´æ–‡ä»¶ï¼Œç¼–è¯‘æ–‡ä»¶ç­‰æ—¶éœ€è¦ä½¿ç”¨
- /usr/libï¼šæ‰€æœ‰å¯æ‰§è¡Œæ–‡ä»¶éœ€è¦çš„åº“æ–‡ä»¶
- /usr/localï¼šå­˜æ”¾æ‰‹åŠ¨å®‰è£…çš„è½¯ä»¶ã€‚
- /usr/docï¼šæ–‡æ¡£ï¼Œ/usr/share/docçš„è½¯è¿æ¥
- /usr/shareï¼šåŒ…å«å„ä¸ªç¨‹åºé—´çš„å…±äº«æ–‡ä»¶ï¼Œå¦‚å­—ä½“ï¼Œå›¾æ ‡ï¼Œæ–‡æ¡£ç­‰ã€‚
- /usr/share/manï¼šmanualæ“ä½œæ‰‹å†Œ
- /usr/srcï¼šLinuxå†…æ ¸çš„æºç å’Œè¯´æ˜æ–‡æ¡£ç­‰

ä¸ä¹‹ç›¸åº”çš„è¿˜æœ‰/varç›®å½•ï¼Œvariableçš„ç®€ç§°ï¼Œä¸»è¦é’ˆå¯¹å¸¸æ€æ€§å˜åŠ¨çš„æ–‡ä»¶ï¼ŒåŒ…æ‹¬ç¼“å­˜cacheã€ç™»é™†æ¡£log fileä»¥åŠæŸäº›è½¯ä»¶è¿ä½œæ‰€äº§ç”Ÿçš„æ–‡ä»¶ã€‚

- /var/cacheï¼šåº”ç”¨ç¨‹åºæœ¬èº«è¿ä½œè¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿä¸€äº›æš‚å­˜æ–‡æ¡£
- /var/libï¼šç¨‹åºæœ¬èº«æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ä½¿ç”¨åˆ°çš„æ•°æ®æ–‡ä»¶æ”¾ç½®çš„ç›®å½•ã€‚åœ¨æ­¤ç›®å½•ä¸‹å„è‡ªçš„è½¯ä»¶åº”è¯¥è¦æœ‰å„è‡ªçš„ç›®å½•ã€‚ä¸¾ä¾‹æ¥è¯´ï¼ŒMySQLçš„æ•°æ®åº“æ”¾ç½®åˆ°/var/lib/mysqlè€Œrpmçš„æ•°æ®åˆ™æ”¾åˆ°/var/lib/rpmå»
- /var/lockï¼šæŸäº›è£…ç½®æˆ–è€…äº‹æ–‡ä»¶èµ„æºä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªåº”ç”¨ç¨‹åºæ‰€ä½¿ç”¨å“¦ï¼Œå¦‚æœåŒæ—¶æœ‰ä¸¤ä¸ªç¨‹åºä½¿ç”¨è¯¥è£…ç½®æ—¶ï¼Œå°±å¯èƒ½äº§ç”Ÿä¸€äº›é”™è¯¯çš„æƒ…å†µï¼Œå› æ­¤å°±å¾—è¦åœ¨è¯¥è£…ç½®ä¸Šé”ã€‚
- /var/logï¼šéå¸¸é‡è¦ã€‚è¿™æ˜¯ç™»é™†æ–‡ä»¶æ”¾ç½®çš„ç›®å½•ã€‚é‡Œé¢æ¯”è¾ƒé‡è¦çš„æ–‡ä»¶ï¼Œæ¯”å¦‚/var/log/messages,/var/log/wtmpè®°å½•ç™»å…¥è€…çš„ä¿¡æ¯ç­‰ã€‚
- /var/mailï¼šæ”¾ç½®ä¸ªäººç”µå­é‚®ä»¶ä¿¡ç®±çš„ç›®å½•ï¼Œä¸è¿‡è¿™ä¸ªç›®å½•ä¹Ÿè¢«æ”¾ç½®åˆ°/var/spool/mailç›®å½•ä¸­ï¼Œé€šå¸¸è¿™ä¸¤ä¸ªç›®å½•æ˜¯äº’ä¸ºé“¾æ¥æ–‡ä»¶ã€‚
- /var/runï¼šæŸäº›ç¨‹åºæˆ–è€…æœåŠ¡å¯åŠ¨åï¼Œä¼šå°†ä»–ä»¬çš„PIDæ”¾ç½®åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚
- /var/spoolï¼šè¿™ä¸ªç›®å½•é€šå¸¸æ”¾ç½®ä¸€äº›é˜Ÿåˆ—æ•°æ®ï¼Œæ‰€è°“é˜Ÿåˆ—å°±æ˜¯æ’é˜Ÿç­‰å¾…å…¶ä»–ç¨‹åºä½¿ç”¨çš„æ•°æ®ã€‚è¿™äº›æ•°æ®è¢«ä½¿ç”¨åé€šå¸¸ä¼šè¢«åˆ é™¤ã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œç³»ç»Ÿæ”¶åˆ°æ–°ä¿¡æƒ æ”¾ç½®åˆ°/var/spool/mailä¸­ï¼Œä½†ä½¿ç”¨è€…æ”¶ä¸‹è¯¥ä¿¡ä»¶ååŸåˆ™ä¸Šä¼šè¢«åˆ é™¤ï¼Œå¦‚æœæš‚æ—¶å¯„ä¸å‡ºå»ä¼šæ”¾åˆ°/var/spool/mqueueä¸­ï¼Œç­‰è¢«é€å‡ºåå°±è¦è¢«åˆ é™¤ã€‚å¦‚æœæ˜¯å·¥ä½œæ’ç¨‹æ•°æ®crontabï¼Œå°±ä¼šæ”¾åˆ°/var/spool/cronç›®å½•ä¸­ã€‚

åœ¨å®‰è£…ä¹‹åè®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡

```shell
echo 'export PATH="/usr/local/opt/mysql@5.7/bin:$PATH"' >> /Users/jiawenhao/.bash_profile
echo 'export LDFLAGS="-L/usr/local/opt/mysql@5.7/lib"'>> /Users/jiawenhao/.bash_profile 
echo 'export CPPFLAGS="-I/usr/local/opt/mysql@5.7/include"'>> /Users/jiawenhao/.bash_profile
```

å¯åŠ¨mysql

```shell
brew services start mysql@5.7
if you don't want/need a background service you can just run:
/usr/local/opt/mysql@5.7/bin/mysql.server start
brew services stop mysql@5.7
brew services restart mysql@5.7
brew services list
```

æ’æŸ¥é—®é¢˜

> ERROR! The server quit without updating PID file (/usr/local/var/mysql/your_computer_name-Pro.local.pid).

```
ps aux | grep mysqld | grep grep -v
sudo kill -9 mysqlpid
```

Googleäº†å¾ˆå¤šæ–‡ç« ï¼Œéƒ½è¯´killæ‰é‡å¯å°±ä¼šå¥½ï¼Œå‘ç°æ— æ³•æ€æ‰è¿›ç¨‹ï¼Œæ¯æ¬¡killæ‰éƒ½ä¼šè‡ªå·±èµ·ä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œè€Œä¸”è¿™ä¸ªæ— æ³•killçš„mysqlè¿›ç¨‹è¿˜æ˜¯_mysqlç”¨æˆ·èµ·æ¥çš„ï¼Œå¾ˆæ˜æ˜¾è·Ÿæˆ‘æ²¡å•¥å…³ç³»ï¼Œäºæ˜¯å¼€å§‹Googleå¦‚ä½•killæ‰è¿™ä¸ªmysqldè¿›ç¨‹ï¼Œç„¶åçœ‹ä¸‹é¢çš„å‘½ä»¤

```
sudo launchctl unload -w /Library/LaunchDaemons/com.oracle.oss.mysql.mysqld.plist
```

å†ç„¶åkill -9 mysqldidå°±å¯ä»¥äº†ï¼ŒåŸå› è¿™é‡Œç®€è¿°ä¸€ä¸‹ï¼Œå¹¶ä¸æ·±å…¥ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼šMacç³»ç»Ÿåœ¨æ›´æ–°OS Xä¹‹åï¼ŒåŠ å…¥äº† "Rootlessæœºåˆ¶"ï¼Œä¹Ÿå°±æ„å‘³ç€æœ‰ä¸€äº›ç›®å½•çš„å†…å®¹æˆ‘ä»¬æ— æ³•è¿›è¡Œéšæ„çš„è¿›è¡Œè¯»å†™ï¼›å³ä½¿è®¾ç½®rootæƒé™ä¹Ÿä¸èƒ½ä½¿ç”¨ã€‚å¾—ï¼Œæ€»è€Œè¨€ä¹‹å°±æ˜¯å‘ï¼ŒæŠŠ

[é“¾æ¥]: https://blog.csdn.net/ws1836300/article/details/108850641?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-0&amp;spm=1001.2101.3001.4242

è´´ä¸Šæ¥ã€‚

ç„¶åå°±æ˜¯ç»§ç»­mysql@5.7

```
mysql_secure_installation
```

ç»“æŸï¼

### Redis

```shell
brew search redis
brew install redis@4.0
echo 'export PATH="/usr/local/opt/redis@4.0/bin:$PATH"' >> /Users/jiawenhao/.bash_profile
```

å¯åŠ¨redis

```
brew services start redis@4.0
if you don't want/need a background service you can just run:
/usr/local/opt/redis@4.0/bin/redis-server /usr/local/etc/redis.conf
```

